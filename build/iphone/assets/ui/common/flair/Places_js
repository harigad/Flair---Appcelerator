function _reloadPlaces(){clear(_placesView),_placesView.add(Ti.UI.createImageView({image:"images/load.gif",width:"50",left:120,top:75})),portal.getPlaces(printPlaces)}function printPlaces(e){clear(_placesView);var t;t=12,e.length<12&&(t=e.length);var n;for(var r=0;r<t;r++)r%2?n="#dddddd":n="#eeeeee",_placesView.add(_createFlairThumb(e[r],n))}function _createFlairThumb(e,t){var n=_createThumb(e,t);return n.addEventListener("click",function(){var t=require("ui/common/flair/Flair");_callBack(e)}),n}function _createThumb(e,t){var n=Ti.UI.createView({width:100,height:100,top:-2.5,bottom:-2.5,left:-2.5,right:-2.5,borderRadius:4,_data:e}),r=Ti.UI.createView({width:"85",height:"85",backgroundColor:t,borderRadius:4}),i=Ti.UI.createLabel({height:"auto",width:80,text:e.name,color:"#999",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,font:{fontSize:12}});return r.add(i),n.add(r),n.addEventListener("touchstart",function(e){this._cancelClick=!1,this.setOpacity(.3)}),n.addEventListener("touchend",function(e){this.setOpacity(1)}),n.addEventListener("touchmove",function(e){this._cancelClick=!0,this.setOpacity(1)}),n}function clear(e){Ti.API.debug("clearing tableView with items = "+e.children.length);for(var t=0;t<e.children.length;t++){var n=e.children[t];e.remove(n)}Ti.API.debug("clearing done with items = "+e.children.length)}var portal=require("ui/common/Portal"),_callBack,_placesView;exports.init=function(e){_callBack=e;var t=Ti.UI.createView({width:"320",height:"auto",top:0,left:0,layout:"horizontal"}),n=Ti.UI.createView({width:"100%",height:"50",layout:"horizontal",backgroundColor:"#eee"}),r=Ti.UI.createImageView({image:"images/reload.png",left:17.5}),i=Ti.UI.createLabel({height:"60",left:5,text:"reload",color:"#999",font:{fontSize:12}});n.add(r),n.add(i),r.addEventListener("click",function(e){_reloadPlaces()}),i.addEventListener("click",function(e){_reloadPlaces()});var s=Ti.UI.createImageView({image:"images/cancel.png",left:5}),o=Ti.UI.createLabel({height:"60",left:135,text:"cancel",color:"#999",font:{fontSize:12}});n.add(o),n.add(s),t.add(n),s.addEventListener("click",function(e){var t=require("ui/common/flair/Flair");t.close()}),o.addEventListener("click",function(e){var t=require("ui/common/flair/Flair");t.close()}),_placesView=Ti.UI.createView({width:"290",height:"auto",top:8,left:17.5,layout:"horizontal"}),t.add(_placesView);var u=portal.getPlaces();return printPlaces(u),t}