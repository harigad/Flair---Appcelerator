function loadPlaces(e){var t="https://flair.me/search.php",n={};n.type="search",n.searchMode="place",n.lat=_location.latitude,n.lng=_location.longitude,n.accessToken=Ti.Facebook.getAccessToken();var r=Ti.Network.createHTTPClient({onload:function(t){_places=JSON.parse(this.responseText),e&&e(_places)},onerror:function(e){Ti.API.error("Sending Flair to Server "+e.error)},timeout:5e3});r.open("POST",t),r.send(n)}function initLocation(){Ti.Geolocation.purpose="Find nearby Places",Ti.Geolocation.accuracy=Ti.Geolocation.ACCURACY_BEST,Ti.Geolocation.distanceFilter=10;var e=Ti.Geolocation.getCurrentPosition(function(e){if(e.error){Ti.API.log("error: "+JSON.stringify(e.error));return}var t=require("ui/common/Portal");_location=e.coords,_places||loadPlaces()})}var main,nav,_location,_places;exports.getLocation=function(){return _location},exports.getPlaces=function(e){if(!e)return _places;loadPlaces(e)},exports.remove=function(e){e.close(),nav.remove(e)},exports.init=function(){main=Ti.UI.createWindow();var e=require("ui/common/home/Home"),t=e.init();nav=Ti.UI.iPhone.createNavigationGroup({window:t}),main.add(nav),nav.open(t,{animated:!0}),main.open(),initLocation()},exports.open=function(e){nav.open(e,{animated:!0})}