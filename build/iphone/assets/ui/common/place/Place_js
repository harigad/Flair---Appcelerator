function print_cast(e){var t=Ti.UI.createView({height:Ti.UI.SIZE,layout:"vertical",top:0,left:0});_tabViews.add(t),_tabViews._castView=t,Ti.API.debug("places.cast length "+e.cast.length);for(var n=0;n<e.foods.length;n++){var r=Ti.UI.createView({height:Ti.UI.SIZE,width:"100%",left:0,top:0,layout:"horizontal"}),i=_createThumb({},"#dedede"),s=Ti.UI.createView({height:Ti.UI.SIZE,width:"180",left:0,top:0,layout:"vertical"}),o=Ti.UI.createLabel({left:0,top:10,width:Ti.UI.FILL,color:"#aaa",text:e.cast[n].name,font:{fontSize:42}}),u=Ti.UI.createLabel({left:0,bottom:10,width:Ti.UI.FILL,color:"#2179ca",text:e.cast[n].role_name,font:{fontSize:20}});s.add(o),s.add(u),r.add(i),r.add(s),t.add(r),t.add(_hr())}var a=3-e.cast.length;for(var n=0;n<a;n++){var r=Ti.UI.createView({height:Ti.UI.SIZE,width:"100%",left:0,top:0,layout:"horizontal"});r.add(_createThumb(e.cast[n],"")),t.add(r),t.add(_hr())}}function print_food(e){var t=Ti.UI.createView({height:Ti.UI.SIZE,layout:"vertical",top:0,left:0,visible:!1});_tabViews.add(t),_tabViews._foodView=t,Ti.API.debug("places.cast length "+e.cast.length);for(var n=0;n<e.foods.length;n++){var r=Ti.UI.createView({height:Ti.UI.SIZE,width:"100%",left:0,top:0,layout:"horizontal"}),i=_createThumb(e.foods[n],"#dedede"),s=Ti.UI.createView({height:Ti.UI.SIZE,width:"180",left:0,top:0,layout:"vertical"}),o=Ti.UI.createLabel({left:0,top:10,width:Ti.UI.FILL,color:"#aaa",text:e.foods[n].name,font:{fontSize:42}});s.add(o),r.add(i),r.add(s),t.add(r),t.add(_hr())}var u=3-e.cast.length;for(var n=0;n<u;n++){var r=Ti.UI.createView({height:Ti.UI.SIZE,width:"100%",left:0,top:0,layout:"horizontal"});r.add(_createThumb({},"")),t.add(r),t.add(_hr())}}function loadData(e){var t=this,n="http://flair.me/search.php",r={};r.type="search",r.searchMode="place",r.pid=e.pid,r.accessToken=Ti.Facebook.getAccessToken();var i=Ti.Network.createHTTPClient({onload:function(e){Ti.API.debug(JSON.stringify(this.responseText));var t=JSON.parse(this.responseText);print_food(t),print_cast(t)},onerror:function(t){Ti.API.error("error loading data for Place -> "+e.pid),Ti.API.error(t.error)},timeout:5e3});i.open("POST",n),i.send(r)}function _createThumb(e,t){var n=Ti.UI.createView({width:120,height:120}),r=Ti.UI.createView({width:"100",height:"100",borderRadius:4,backgroundColor:t}),i=Ti.UI.createView({width:"80",height:"80",backgroundImage:e.photo});return r.add(i),n.add(r),n}function _hr(){return Ti.UI.createView({backgroundImage:"images/feed/like_hr.png",height:2,bottom:0,width:"320"})}var _lat,_lng,portal=require("ui/common/Portal"),view,_tabViews;exports.init=function(e){var t=Ti.UI.createWindow({barColor:"#333",backgroundColor:"#eee"});loadData(e);var n=Ti.UI.createScrollView({contentWidth:"auto",contentHeight:"auto",showVerticalScrollIndicator:!1,showHorizontalScrollIndicator:!1,width:320,top:0});view=Ti.UI.createView({top:"0",height:Ti.UI.SIZE,layout:"vertical"});var r=Ti.Map.createView({mapType:Ti.Map.STANDARD_TYPE,region:{latitude:e.lat,longitude:e.lng,latitudeDelta:.005,longitudeDelta:.005},animate:!0,regionFit:!0,userLocation:!0}),i=Ti.UI.createView({top:"0",height:"120"}),s=Ti.UI.createView({top:"0",height:"120",width:"320",bubbleParent:!0,backgroundImage:"images/map_shade.png",layout:"vertical"}),o=Ti.UI.createLabel({left:10,top:"55",width:Ti.UI.SIZE,height:Ti.UI.SIZE,shadowColor:"#333333",color:"#fff",text:e.name,font:{fontSize:16,fontWeight:"bold"}});s.add(o);var u=Ti.UI.createLabel({left:10,width:"150",height:Ti.UI.SIZE,color:"#fff",text:e.vicinity,font:{fontSize:14}});s.add(u),i.add(r),r.add(s),view.add(i);var a=Ti.UI.createView({height:"40",width:"320",backgroundColor:"#999"});_tabViews=Ti.UI.createView({height:Ti.UI.SIZE,width:Ti.UI.FILL});var f=Ti.UI.iOS.createTabbedBar({labels:[{enabled:!0,title:"cast"},{enabled:!0,title:"menu"}],backgroundColor:"#999",top:5,style:Ti.UI.iPhone.SystemButtonStyle.BAR,height:30,width:280,_tabViews:_tabViews,index:0});return a.add(f),f.addEventListener("click",function(e){e.index===0?(this._tabViews._foodView.hide(),this._tabViews._castView.show()):(this._tabViews._castView.hide(),this._tabViews._foodView.show())}),view.add(a),view.add(_tabViews),n.add(view),t.add(n),t}