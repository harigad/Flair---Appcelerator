function loadUser(e,t){Ti.API.debug("loading user from server "+e);var n=require("ui/common/data/User");e==login.getUser().getId()?(t.user=login.getUser(),user=t.user,printDetails()):t.user=new n(e,function(e){Ti.API.info("userProfile.loadUser"),user=e,printDetails()})}function clearView(e){return}function printDetails(e){Ti.API.debug("UserProfile.printDetails"),photoView.setImage(user.getPhotoBig()),clearView(!0);if(user.getPlace()||user.isAdmin())grayV=printPlace(user),view.add(grayV);if(user.getId())var t=require("ui/common/feed/FeedView"),n=new t(user.feed(),main);else view.add(userHasNotClaimed())}function userHasNotClaimed(){var e=Ti.UI.createView({layout:"horizontal",left:10,right:10,top:10});return e}function printPlace(e){var t=e.getPlace(),n=Ti.UI.createView({backgroundColor:"#333",width:"100%",height:"auto",layout:"horizontal"}),r=Ti.UI.createImageView({image:"images/profile/oscar_48.png",left:10,right:10,top:10,bottom:10,width:50,height:50});n.add(r);var i=Ti.UI.createView({height:"auto",width:250,left:0,top:10,bottom:10,layout:"vertical"});if(t&&!t.code){var s=Ti.UI.createLabel({left:0,width:"auto",color:"#eee",text:t.role,font:{fontSize:16}}),o=Ti.UI.createLabel({left:0,width:"auto",color:"#2179ca",shadowColor:"#aaa",shadowOffset:{x:1,y:1},text:t.name,font:{fontSize:25}}),u=Ti.UI.createView({width:"auto",height:"auto",layout:"horizontal",left:0});if(e.getId()==login.getUser().getId()){var a=Ti.UI.createImageView({image:"images/profile/settings2.png",left:0,right:5,height:25}),f=Ti.UI.createLabel({left:0,width:"auto",color:"#2179ca",text:"(edit)",font:{fontSize:14}});u.add(a),u.add(f),u.addEventListener("click",function(e){var t=require("ui/common/userProfile/EditRole");portal.open(t.init())})}s.addEventListener("click",function(){var e=require("ui/common/place/Place");portal.open(e.init(t))}),o.addEventListener("click",function(){var e=require("ui/common/place/Place");portal.open(e.init(t))}),i.add(s),i.add(o),i.add(u)}else if(t&&t.code){var l=Ti.UI.createLabel({left:0,width:"auto",color:"#eee",wordWrap:!1,text:t.name+" - "+t.vicinity,font:{fontSize:14}}),o=Ti.UI.createLabel({left:0,width:"auto",color:"#2179ca",text:"Activation Code : "+t.code,font:{fontSize:18}});i.add(o),i.add(l);var c=Ti.UI.createView({height:"auto",width:250,left:0,top:0,layout:"horizontal"});i.add(c);var h=Ti.UI.createLabel({right:5,top:3,width:"auto",color:"#eee",text:"Dial ",font:{fontSize:14}});c.add(h);var h=Ti.UI.createLabel({right:5,top:3,width:"auto",color:"#eee",text:"1-866-291-9993",font:{fontSize:14,fontWeight:"bold"}});c.add(h);var h=Ti.UI.createLabel({right:5,top:3,width:"auto",color:"#eee",text:"from the",font:{fontSize:14}});c.add(h);var h=Ti.UI.createLabel({right:5,top:3,width:"auto",color:"#eee",text:"landline",font:{fontSize:14,fontWeight:"bold"}});c.add(h);var h=Ti.UI.createLabel({right:5,top:3,width:"auto",color:"#eee",text:"@ the",font:{fontSize:14}});c.add(h);var h=Ti.UI.createLabel({right:5,top:3,width:"auto",color:"#eee",text:t.name,font:{fontSize:14,fontWeight:"bold"}});c.add(h);var h=Ti.UI.createLabel({right:5,top:3,width:"auto",color:"#eee",text:"and enter",font:{fontSize:14}});c.add(h);var h=Ti.UI.createLabel({right:5,top:3,width:"auto",color:"#eee",text:"the above",font:{fontSize:14}});c.add(h);var h=Ti.UI.createLabel({top:3,width:"auto",color:"#eee",text:"verification code.",font:{fontSize:14}});c.add(h),i.addEventListener("click",function(){var e=require("ui/common/userProfile/SearchPlace");e.launch()})}else if(!t&&e.isAdmin()){var l=Ti.UI.createLabel({left:0,width:"auto",color:"#eee",text:"ADD NEW",font:{fontSize:16}}),o=Ti.UI.createLabel({left:0,width:"auto",color:"#2179ca",text:"Restaurant/Cafe",font:{fontSize:25}});i.add(l),i.add(o),i.addEventListener("click",function(){var e=require("ui/common/userProfile/SearchPlace");e.launch()})}return n.add(i),n}var view,user,grayV,photoView,main,portal=require("ui/common/Portal"),login=require("ui/common/Login");exports.init=function(e,t,n){var r={x:0,y:60};main=Ti.UI.createTableView({width:"320",top:-2,backgroundColor:"#fff"}),main.userId=e,main.userName=t,view=Ti.UI.createView({width:"100%",height:"auto",top:0,layout:"vertical"});var i=Ti.UI.createImageView({image:"images/loading_white.gif",width:"50",top:0});photoView=Ti.UI.createImageView({image:n,width:320,height:200,top:0,backgroundColor:"#000"}),view.add(photoView);var s=Ti.UI.createTableViewRow({height:"auto"});return s.add(view),main.appendRow(s),main.contentScreen=view,main.userPhotoView=photoView,loadUser(e,main),main},exports.refresh=function(){Ti.API.debug("in refresh"),printDetails(!0)}