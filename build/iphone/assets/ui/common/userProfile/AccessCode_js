function _build(e){clear(_view);if(!_place){e&&_loadCode(e);return}var t=Ti.UI.createLabel({top:10,left:10,right:10,width:300,color:"#666",text:_place.name,font:{fontSize:22}});_view.add(t);var t=Ti.UI.createLabel({top:0,left:10,right:10,width:300,color:"#666",text:_place.vicinity,font:{fontSize:14}});_view.add(t);var n=Ti.UI.createLabel({top:10,left:10,width:"auto",color:"#999",text:"Access Code : ",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,font:{fontSize:22}});_view.add(n);var n=Ti.UI.createLabel({top:10,width:Ti.UI.SIZE,color:"#2179ca",text:" "+_place.code,textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,font:{fontSize:22}});_view.add(n);var r=Ti.UI.createLabel({top:10,left:10,right:10,width:300,color:"#333",text:"Dial 1-866-291-9993 from the landline @ the "+_place.name+"</b> and enter the above verification code.",font:{fontSize:14}});_view.add(r);var i=Ti.UI.createView({width:300,height:60,top:20,left:10,layout:"horizontal",borderRadius:4,backgroundColor:"#2179ca"});_view.add(i);var s=Ti.UI.createLabel({top:15,bottom:15,width:280,left:10,right:10,color:"#fff",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"SAVE",font:{fontSize:18}});i.add(s);var o=Ti.UI.createView({width:300,height:60,top:10,left:10,layout:"horizontal",borderRadius:4,backgroundColor:"#770000"});_view.add(o);var u=Ti.UI.createLabel({top:15,bottom:15,width:280,left:10,right:10,color:"#fff",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"DELETE",font:{fontSize:18}});o.add(u),o.addEventListener("click",function(){_deleteCode(user.getPlace()),user.setPlace(null),searchPlaceNav.close(!0),main.close()}),i.addEventListener("click",function(){searchPlaceNav.close(!0),main.close()}),main.open()}function _deleteCode(e){var t="http://flair.me/search.php",e={type:"role",pid:e.pid,accessToken:Ti.Facebook.getAccessToken(),action:"delete"},n=Ti.Network.createHTTPClient({onload:function(e){},onerror:function(e){}});n.open("POST",t),n.send(e)}function _loadCode(e){var t="http://flair.me/search.php",e={type:"role",pid:e.pid,accessToken:Ti.Facebook.getAccessToken()},n=Ti.Network.createHTTPClient({onload:function(e){var t=JSON.parse(this.responseText);t.status&&(user.setPlace(t.place),_place=t.place,_build())},onerror:function(e){Ti.API.error("User.load error "+e)}});n.open("POST",t),n.send(e)}function _init(e){main=Ti.UI.createWindow({title:"New Access Code",barColor:"#333",backgroundColor:"#eee"}),_view=Ti.UI.createView({width:"100%",height:"auto",top:0,layout:"horizontal"}),main.add(_view),_build(e)}function clear(e){Ti.API.debug("clearing tableView with items = "+e.children.length);for(var t=0;t<e.children.length;t++){var n=e.children[t];e.remove(n)}Ti.API.debug("clearing done with items = "+e.children.length)}var login=require("ui/common/Login"),searchPlaceNav=require("ui/common/userProfile/SearchPlace"),user=login.getUser(),_view,main,_place;exports.launch=function(e,t){t?_place=t:_place=null,_view?_build(e):_init(e)}