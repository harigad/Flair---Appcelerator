function _build(e,t){var n=Ti.Map.createView({mapType:Ti.Map.STANDARD_TYPE,region:{latitude:e.lat,longitude:e.lng,latitudeDelta:.005,longitudeDelta:.005},animate:!0,regionFit:!0,userLocation:!0}),r=Ti.UI.createView({top:"0",height:"200"}),i=Ti.UI.createView({top:"0",height:"200",width:"320",bubbleParent:!0,backgroundImage:"images/map_shade.png",layout:"vertical"}),s=Ti.UI.createLabel({left:10,top:"120",width:Ti.UI.SIZE,height:Ti.UI.SIZE,shadowColor:"#333333",color:"#fff",text:e.name,font:{fontSize:16,fontWeight:"bold"}});i.add(s);var o=Ti.UI.createLabel({left:10,width:"150",height:Ti.UI.SIZE,color:"#fff",text:e.vicinity,font:{fontSize:14}});i.add(o),r.add(n),n.add(i),_view.add(r);var u=Ti.UI.createView({width:300,height:60,top:20,left:10,layout:"horizontal",borderRadius:4,backgroundColor:"#2179ca"});_view.add(u);var a=Ti.UI.createLabel({top:15,bottom:15,width:280,left:10,right:10,color:"#fff",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"I Work Here",font:{fontSize:18}});u.add(a);var f=Ti.UI.createView({width:300,height:60,top:10,left:10,layout:"horizontal",borderRadius:4,backgroundColor:"#770000"});_view.add(f);var l=Ti.UI.createLabel({top:15,bottom:15,width:280,left:10,right:10,color:"#fff",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"No! I dont.",font:{fontSize:18}});f.add(l),f.addEventListener("singletap",function(){_deleteCode(user.getPlace()),user.setPlace(null),searchPlaceNav.close(!0,user),main.close({transition:Ti.UI.iPhone.AnimationStyle.FLIP_FROM_LEFT})}),u.addEventListener("singletap",function(){_loadCode(e)}),t?main.open():main.open({transition:Ti.UI.iPhone.AnimationStyle.FLIP_FROM_RIGHT})}function _deleteCode(e){var t="http://flair.me/search.php",e={type:"role",pid:e.pid,accessToken:Ti.Facebook.getAccessToken(),action:"delete"},n=Ti.Network.createHTTPClient({onload:function(e){},onerror:function(e){}});n.open("POST",t),n.send(e)}function _loadCode(e){if(user.getPlace()===e){searchPlaceNav.close(!1),main.close({transition:Ti.UI.iPhone.AnimationStyle.FLIP_FROM_LEFT});return}var t="http://flair.me/search.php",e={type:"role",pid:e.pid,accessToken:Ti.Facebook.getAccessToken()},n=Ti.Network.createHTTPClient({onload:function(e){var t=JSON.parse(this.responseText);t.status&&(user.setPlace(t.place),searchPlaceNav.close(!0,user),main.close())},onerror:function(e){Ti.API.error("User.load error "+e)}});n.open("POST",t),n.send(e)}function _init(e,t){main=Ti.UI.createWindow({title:"New Access Code",barColor:"#333",backgroundColor:"#eee"}),_view=Ti.UI.createView({width:"100%",height:"auto",top:0,layout:"horizontal"}),main.add(_view),_build(e,t)}function clear(e){Ti.API.debug("clearing tableView with items = "+e.children.length);for(var t=0;t<e.children.length;t++){var n=e.children[t];e.remove(n)}Ti.API.debug("clearing done with items = "+e.children.length)}var login=require("ui/common/Login"),searchPlaceNav=require("ui/common/userProfile/SearchPlace"),user=login.getUser(),_view,main,_place;exports.launch=function(e,t){_init(e,t)}